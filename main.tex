\documentclass[aspectratio=169,usenames,dvipsnames]{beamer}

\usepackage{amsmath}
\usepackage{booktabs}
\usepackage{xcolor}
\usepackage[english]{babel}
\usepackage{unicode-math}
\usepackage{mathtools}
\usepackage{derivative}
\usepackage{makecell}
\usepackage{multirow}
\usepackage{siunitx}
\usepackage{pgfplots}
\usepackage{circuitikz}
\usepackage{appendixnumberbeamer}

\usetheme{metropolis}

\setmainfont{Stix Two Text}
\setmathfont{Stix Two Math}

\input{math}

\pgfplotsset{compat=1.17}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{fit}
\usetikzlibrary{positioning}
\usepgfplotslibrary{groupplots}

\definecolor{exotic orange}{RGB}{255,128,0}
\definecolor{exotic green}{RGB}{0,102,102}
\definecolor{exotic blue}{RGB}{67,132,161}
\definecolor{exotic red}{RGB}{250,86,86}

\title{A theoretical framework for CV-QKD}
\date{\today}
\author{Bodo Kaiser}
\institute{Ludwig-Maximilians-Universität München}

\begin{document}
	\maketitle
	
	% why is QKD interesting? -> intersection of multiple disciplines (quantum information theory, quantum optics, communication engineering)	
	\begin{frame}{Preview}
		\begin{columns}[c, onlytextwidth]
			\column{0.6\textwidth}
			\begin{figure}
				\begin{tikzpicture}[
					venn circle/.style={draw, very thick, fill opacity=0.25, circle, minimum width=45mm},
					venn label/.style={align=center},
				]
					\begin{scope}[blend group=soft light]
						\node[venn circle, fill=exotic red] (qp) at (90:1.4) {};
						\node[venn circle, fill=exotic green] (it) at (210:1.4) {};
						\node[venn circle, fill=exotic orange] (qp) at (330:1.4) {};
					\end{scope}
					
					\node[venn label] {QKD};
					\node[venn label] at (90:2.5) {Communication\\engineering};
					\node[venn label] at (210:2.5) {Quantum\\physics};
					\node[venn label] at (330:2.5) {Information\\theory};
				\end{tikzpicture}
			\end{figure}

			\column{0.4\textwidth}
			\setbeamertemplate{section in toc}[sections numbered]
			\tableofcontents[hideallsubsections]
		\end{columns}
	\end{frame}
	
	\section{Introduction}

	% what is secure communication: integrity and confidentiality	
	% key distribution problem
	% public-key distribution
	% information-theoretical secure for OTP but practically one uses AES
	\begin{frame}{Secure transmission system}
		\begin{figure}
			\begin{tikzpicture}[
				node distance=5mm,
				arrow/.style={very thick, -Latex},
				block/.style={draw, very thick, minimum width=28mm, minimum height=10mm},		
			]
				\coordinate (in);
				\node[block, above=of in] (encryption) {Encrypter};
				\node[block, above=of encryption] (authentication) {Authenticator};
				\node[block, above=of authentication] (transmitter) {Transmitter};
				\node[block, right=10mm of transmitter] (channel) {Channel};
				\node[block, right=10mm of channel] (receiver) {Receiver};
				\node[block, below=of receiver] (verification) {Verificier};
				\node[block, below=of verification] (decryption) {Decrypter};
				\coordinate[below=of decryption] (out);
	
				\path (encryption) -- (verification) node[midway, block, align=center] (key) {Secret-key};
	
				\draw[arrow] (key.west) to[out=210, in=0] (encryption.east);
				\draw[arrow] (key.west) to[out=150, in=0]  (authentication.east);
				\draw[arrow] (key.east) to[out=-30, in=180] (decryption.west);
				\draw[arrow] (key.east) to[out=30, in=180] (verification.west);

				\draw[arrow] (in) -- (encryption);
				\draw[arrow] (encryption) -- (authentication);
				\draw[arrow] (authentication) -- (transmitter);
				
				\draw[arrow] (decryption) -- (out);
				\draw[arrow] (verification) -- (decryption);
				\draw[arrow] (receiver) -- (verification);
		
				\draw[arrow] (transmitter) -- (channel.west);
				\draw[arrow] (channel.east) -- (receiver);
				
				\node[label={Alice}, fit=(encryption) (transmitter)] {};
				\node[label={Bob}, fit=(decryption) (receiver)] {};
			\end{tikzpicture}
			\caption{Block diagram of a secure transmission system.}
		\end{figure}
	\end{frame}

    % quantum transmission (random seed, correlated data)
	% post-processing (shared secret key from correlated data)
	\begin{frame}{Quantum key distribution system}
		\begin{figure}
			\begin{tikzpicture}[
				node distance=5mm,
				arrow/.style={very thick, -Latex},
				block/.style={draw, very thick, minimum width=28mm, minimum height=10mm},		
			]
				\node[block] (alice) {Alice};
				\node[block, right=14mm of alice] (eve) {Eve};
				\node[block, above=10mm of eve] (quantum channel) {Quantum channel};
				\node[block, below=10mm of eve] (classical channel) {Classical channel};
				\node[block, right=14mm of eve] (bob) {Bob};

				\draw[arrow] (eve) -- (classical channel) node[midway, left, yshift=1mm] {read};
				\draw[arrow] (eve) -- (quantum channel) node[midway, left, yshift=-1mm] {read} node[midway, right, yshift=-1mm] {write};
				\draw[arrow] (alice.north) -- (alice.north|-quantum channel.west) -- (quantum channel.west);
				\draw[arrow, Latex-Latex] (alice.south) -- (alice.south|-classical channel.west) -- (classical channel.west);
				\draw[arrow] (quantum channel.east) -- (quantum channel.east-|bob.north) -- (bob.north);
				\draw[arrow, Latex-Latex] (classical channel.east) -- (classical channel.east-|bob.south) -- (bob.south);
			\end{tikzpicture}
			\caption{Block diagram of a quantum key distribution (QKD) system.}
		\end{figure}
	\end{frame}
	
	\begin{frame}{Discrete and continuous-variable QKD}
		\begin{table}[htb]
			\caption{Comparison of discrete- and continuous-variable QKD.}
			\begin{tabular}{lcc}
				\toprule
					& Discrete & Continuous \\
				\midrule
					Visualization & Bloch sphere & Phase space \\
					Hilbert space (dim) & Finite (two) & Countable (infinite) \\
					Observable & $\vb{\hat{S}}(\vb{n})=\hat{S}_in^i$ & $\hat{X}(\vartheta)=\frac{1}{\sqrt{2}}\left(\hat{a}e^{-i\vartheta}+\hat{a}^\dagger e^{+i\vartheta}\right)$ \\
					Standard basis & $\left\{\ket{0},\ket{1}\right\}$ & $\left\{\ket{x},\ket{p}\right\}_{x,p\in\mathbb{R}}$ \\
				\bottomrule
			\end{tabular}
		\end{table}
	\end{frame}
	
	\begin{frame}{Continuous-variable QKD using coherent states}
		\begin{figure}
			\begin{tikzpicture}[
				var/.style={draw, very thick, fill opacity=0.25, circle, minimum width=45mm},
			]
				\begin{axis}[
					height=6cm,
					width=\linewidth,
					clip=false,
					axis lines=center,
					axis equal image,
					axis line style=thick,
					xlabel={$\hat{X}(\vartheta)$},
					ylabel={$\hat{X}(\vartheta+\pi/2)$},
					ticks=none,
					xmin=-6,
					xmax=+6.5,
					ymin=-1.2,
					ymax=+3,
					axis line style={thick},
					x label style={anchor=north},
					y label style={anchor=south},
				]
					\begin{scope}[blend group=soft light]					
						\draw[var, fill=exotic green] (axis cs:-5,-0.5) circle (1);
						\draw[var, fill=exotic red] (axis cs:4,2.5) circle (1);
						
						\draw[var, fill=exotic blue] (axis cs:-0.25,-0.025) circle (1);
						\draw[var, fill=exotic orange] (axis cs:0.2,0.125) circle (1);
					\end{scope}

					\addplot[very thick, mark=*, exotic green] coordinates {(-5,-0.5)};
					\addplot[very thick, mark=*, exotic red] coordinates {(4,2.5)};					
					\addplot[very thick, mark=*, exotic blue] coordinates {(-0.25,-0.025)};
					\addplot[very thick, mark=*, exotic orange] coordinates {(0.2,0.125)};
					
					\node at (axis cs:-5,0.8) {$\ket{\alpha_1}$};
					\node at (axis cs:5.4,2.5) {$\ket{\alpha_2}$};
					\node at (axis cs:-1.3,0.9) {$\ket{\beta_1}$};
					\node at (axis cs:1.4,-0.7) {$\ket{\beta_2}$};
		
					\draw[-Latex, dashed, thick] (axis cs:-5,-0.5) -- (axis cs:-0.25,-0.025);
					\draw[-Latex, dashed, thick] (axis cs:4,2.5) -- (axis cs:0.2,0.125);
				\end{axis}
			\end{tikzpicture}
			\caption{Phase space diagram of transmitted and received coherent states with mean (dots) and variances (opaque circles).}
		\end{figure}
	\end{frame}
	
	\begin{frame}{Continuous-variable QKD using continuous-time coherent states}
		\begin{figure}
			\begin{tikzpicture}[
				var/.style={draw, very thick, fill opacity=0.25, circle, minimum width=45mm},
			]
				\begin{axis}[
					height=6cm,
					width=\linewidth,
					clip=false,
					axis lines=center,
					axis equal image,
					axis line style=thick,
					xlabel={$\hat{X}(\vartheta)$},
					ylabel={$\hat{X}(\vartheta+\pi/2)$},
					ticks=none,
					xmin=-6,
					xmax=+6.5,
					ymin=-1.2,
					ymax=+3,
					axis line style={thick},
					x label style={anchor=north},
					y label style={anchor=south},
				]
					\begin{scope}[blend group=soft light]					
						\draw[var, fill=exotic green] (axis cs:-5,-0.5) circle (1);
						\draw[var, fill=exotic red] (axis cs:4,2.5) circle (1);
					\end{scope}

					\addplot[very thick, mark=*, exotic green] coordinates {(-5,-0.5)};
					\addplot[very thick, mark=*, exotic red] coordinates {(4,2.5)};
					
					\node at (axis cs:-5,0.8) {$\ket{\alpha(t)}$};
					\node at (axis cs:4,1.2) {$\ket{\alpha(t+T_s)}$};
					\draw[-Latex, dashed, thick] (axis cs:-5,-0.5) -- (axis cs:4,2.5);
				\end{axis}
			\end{tikzpicture}
			\caption{Phase space diagram of continuous-time coherent states with mean (dots) and variances (opaque circles) at two time instances.}
		\end{figure}
	\end{frame}
	
	\section{Coherent state transmitter}
	
	\begin{frame}{Electro-optical setup}
		\begin{figure}
			\begin{tikzpicture}[
				node distance=15mm,
		        block/.style={draw, very thick, minimum height=10mm, minimum width=20mm},
		        arrow/.style={-Latex},
			]
				\coordinate (src);
				\node[block, right=of src] (tx) {Transmitter};
				\node[block, right=1.3cm of tx] (ch) {Channel};
				\node[block, right=1.3cm of ch] (rx) {Receiver};
				\coordinate[right=of rx] (dst);
				
				\draw[arrow] (src) -- (tx) node[midway, above] {$\left\{\alpha_n\right\}_{n\in I}$};
				\draw[arrow] (tx) -- (ch) node[midway, above] {$\ket{\alpha(t)}$};
				\draw[arrow] (ch) -- (rx) node[midway, above] {$\ket{\beta(t)}$};
				\draw[arrow] (rx) -- (dst) node[midway, above] {$\left\{\beta_n\right\}_{n\in I}$};
			\end{tikzpicture}
			\caption{Foobar}
		\end{figure}
	\end{frame}
	
	\begin{frame}{Signal processing pipeline}
		\begin{figure}
	\begin{tikzpicture}[
		node distance=8mm,
	]
		\begin{scope}
			\node (in) {$\alpha[n]$};
			\node (up) [twoportshape, right=of in, t={$\uparrow k$}] {};
			\node (rrc) [twoportshape, right=of up, t=RRC] {};
			\node (real) [twoportsplitshape, circuitikz/t1={$\Re$}, circuitikz/t2={$\Im$}, right=of rrc] {};
			\node (noop) [right=of real] {};
	
			\node (dacx) [dacshape, above=of noop] {};
			\node (lowx) [lowpassshape, right=of dacx] {};
			\node (mixx) [mixer, right=of lowx] {};
	
			\node (dacp) [dacshape, below=of noop] {};
			\node (lowp) [lowpassshape, right=of dacp] {};
			\node (mixp) [mixer, right=of lowp] {};
	
			\node (split) [twoportsplitshape, circuitikz/t1={\ \SI{90}{\degree}}, circuitikz/t2={\SI{0}{\degree}}] at (mixx.south|-real.east) {};
			\node (osc) [left=of split] {$\sqrt{2}\sin(\omega_ct+\vartheta)$};
			\node (add) [adder, right=of split] {};
	
			\draw[-Latex] (in) -- (up);
			\draw[-Latex] (up) -- (rrc);
			\draw[-Latex] (rrc) -- (real);
			\draw[-Latex] (osc) -- (split);
	
			\draw[-Latex] (real.north) -- (real.north|-dacx.west) -- (dacx.west);
			\draw[-Latex] (dacx) -- (lowx);
			\draw[-Latex] (lowx) -- (mixx.west);
			\draw[Latex-] (mixx.south) -- (split.north);
			\draw[-Latex] (mixx.east) -- (mixx.east-|add.north) -- (add.north);
	
			\draw[-Latex] (real.south) -- (real.south|-dacp.west) -- (dacp.west);
			\draw[-Latex] (dacp) -- (lowp);
			\draw[-Latex] (lowp) -- (mixp.west);
			\draw[Latex-] (mixp.north) -- (split.south);
			\draw[-Latex] (mixp.east) -- (mixp.east-|add.south) -- (add.south);			
		\end{scope}
		
		\begin{scope}
			\node (channel in) [bandpassshape, right=22.5mm of add] {};
			\node (channel add) [adder, below=of channel in] {};
			\node (channel out) [bandpassshape, below=of channel add] {};
			\node (channel noise) [left=of channel add] {AWGN};
			
			\draw[-Latex] (channel in.south) -- (channel add.north);
			\draw[-Latex] (channel add.south) -- (channel out.north);
			\draw[-Latex] (channel noise) -- (channel add.west);
		\end{scope}
		
		\begin{scope}
			\node (mixa) [mixer, left=of channel out] {};
			\node (low) [lowpassshape, left=of mixa] {};
			\node (osca) [below=of mixa] {$\cos(\omega_ct+\vartheta)$};
			\node (adc) [adcshape, left=of low] {};
			\node (mixd) [mixer, left=of adc] {};
			\node (oscd) [below=of mixd] {$\exp(i\omega_it)$};
			\node (down1) [twoportshape, t={$\downarrow l$}, left=of mixd] {};
			\node (rrc) [twoportshape, t={RRC}, left=of down1] {};
			\node (down2) [twoportshape, t={$\downarrow k$}, left=of rrc] {};
			\node (out) [left=of down2] {$\beta[n]$};
	
			\draw[-Latex] (mixa.west) -- (low.east);
			\draw[-Latex] (low.west) -- (adc.east);
			\draw[-Latex] (adc.west) -- (mixd.east);
			\draw[-Latex] (mixd.west) -- (down1.east);
			\draw[-Latex] (down1.west) -- (rrc.east);
			\draw[-Latex] (rrc.west) -- (down2.east);
			\draw[-Latex] (down2.west) -- (out);
	
			\draw[-Latex] (osca.north) -- (mixa.south);
			\draw[-Latex] (oscd.north) -- (mixd.south);
		\end{scope}
		
		\draw[-Latex] (add.east) -- (channel in.west);
		\draw[-Latex] (channel out.west) -- (mixa.east);
	\end{tikzpicture}
		\end{figure}
	\end{frame}
	
	\begin{frame}{Pulse-shaping}
		\begin{columns}[c, onlytextwidth]
			\column{0.5\textwidth}
			\begin{figure}
				\begin{tikzpicture}
					\begin{groupplot}[
						group style={
							group name=plot,
							group size=1 by 4,
							vertical sep=1mm,
						},
						ylabel style={align=center},
						grid=major,
						width=\linewidth,
						height=27mm,
						cycle list name=exotic,
						axis line style={thick},
					]
						\nextgroupplot[
							xmin=10,
							xmax=20,
							%xlabel={Symbol index $km$},
							%xlabel near ticks,
							%xticklabel pos=top,
							ylabel={$\alpha[km]$},
						]
						\addplot+[
							very thick,
							ycomb,
							mark=o,
							restrict expr to domain={\thisrow{c1}}{10:20},
						] plot table[col sep=comma] {./data/rand-time-tx-sym-real.csv};
						\addplot+[
							very thick,
							ycomb,
							mark=x,
							restrict expr to domain={\thisrow{c1}}{10:20},
						] plot table[col sep=comma] {./data/rand-time-tx-sym-imag.csv};
						\nextgroupplot[
							xmin=10,
							xmax=20,
							xlabel={},
							xticklabels={},
							ylabel={$\rho[m]$},
						]
						\addplot+[
							very thick,
							ycomb,
							mark=o,
							restrict expr to domain={\thisrow{c1}}{10:20},
						] plot table[col sep=comma] {./data/rand-time-tx-up-real.csv};
						\addplot+[
							very thick,
							ycomb,
							mark=x,
							restrict expr to domain={\thisrow{c1}}{10:20},
						] plot table[col sep=comma] {./data/rand-time-tx-up-imag.csv};
						\nextgroupplot[
							xmin=10,
							xmax=20,
							xlabel={},
							xticklabels={},
							ylabel={$\gamma[m]$},
						]
						\addplot+[
							very thick,
							ycomb,
							mark=o,
							restrict expr to domain={\thisrow{c1}}{10:20},
						] plot table[col sep=comma] {./data/rand-time-tx-rrc-real.csv};
						\addplot+[
							very thick,
							ycomb,
							mark=x,
							restrict expr to domain={\thisrow{c1}}{10:20},
						] plot table[col sep=comma] {./data/rand-time-tx-rrc-imag.csv};
						\nextgroupplot[
							xmin=10,
							xmax=20,
							xlabel={Signal time $t/T_s$},
							ylabel={$\alpha(t)$},
						]
						\addplot+[
							very thick,
							no markers,
							restrict expr to domain={\thisrow{c1}}{10:20},
						] plot table[col sep=comma, y expr=\thisrow{c2}*4] {./data/rand-time-tx-lp-real.csv};
						\addplot+[
							very thick,
							no markers,
							restrict expr to domain={\thisrow{c1}}{10:20},
						] plot table[col sep=comma] {./data/rand-time-tx-lp-imag.csv};
					\end{groupplot}
				\end{tikzpicture}
			\end{figure}

			\column{0.5\textwidth}
			\begin{figure}
				\begin{tikzpicture}
					\begin{groupplot}[
						group style={
							group name=plot,
							group size=1 by 5,
							xlabels at=edge bottom,
							xticklabels at=edge bottom,
							vertical sep=1mm,
						},
						grid=major,
						width=\linewidth,
						height=25mm,
						xlabel={Frequency $f/f_s$},
			%			yticklabels={},
						%ylabel={Power spectral\\density (\si{\decibel})},
						%ylabel style={align=center},
						axis line style={thick},
						cycle list name=exotic,
					]
						\nextgroupplot[
							%title={$\alpha[km],x[km]$ encoding symbols},
							xmin=-4,
							xmax=4,
							xtick distance=0.5,
							ymin=-60,
							ymax=5,
						]
						\addplot+[
							very thick,
							no markers,
						] plot table[col sep=comma] {./data/rand-freq-tx-sym.csv};
						\nextgroupplot[
							%title={$\rho[m],r[m]$ after upsampling $\alpha[km],x[km]$},
							xmin=-4,
							xmax=4,
							xtick distance=0.5,
							ymin=-60,
							ymax=5,
			%				ylabel={Upsampling\\$\rho[m],r[m]$},
						]
						\addplot+[
							very thick,
							no markers,
						] plot table[col sep=comma] {./data/rand-freq-tx-up.csv};
						\nextgroupplot[
							%title={$\gamma[m],q[m]$ after pulse-shaping $\rho[m],r[m]$},
							xmin=-4,
							xmax=4,
							xtick distance=0.5,
							ymin=-60,
							ymax=5,
			%				ylabel={Pulse-shaping\\$\gamma[m],q[m]$},
						]
						\addplot+[
							very thick,
							no markers,
						] plot table[col sep=comma] {./data/rand-freq-tx-rrc.csv};
						\nextgroupplot[
							%title={$\gamma(t),q(t)$ after analog converting $\gamma[m],q[m]$},
							xmin=-4,
							xmax=4,
							xtick distance=0.5,
							ymin=-60,
							ymax=5,
							%ylabel={Analog-conv.\\$\gamma(t),q(t)$},
						]
						\addplot+[
							very thick,
							no markers,
						] plot table[col sep=comma] {./data/rand-freq-tx-dac.csv};
						\nextgroupplot[
							%title={$\alpha(t),x(t)$ after anti-aliasing $\gamma(t),q(t)$},
							xmin=-4,
							xmax=4,
							xtick distance=0.5,
							ymin=-60,
							ymax=5,
							%ylabel={Anti-aliasing\\$\alpha(t),x(t)$},
						]
						\addplot+[
							very thick,
							no markers,
						] plot table[col sep=comma] {./data/rand-freq-tx-lp.csv};
					\end{groupplot}
				\end{tikzpicture}
			\end{figure}
		\end{columns}
	\end{frame}
		
	\begin{frame}{Upconversion}
		
	\end{frame}
	
	\begin{frame}{In-phase and quadrature modulator}
		
	\end{frame}
	
	\section{Coherent state receiver}
	
	\begin{frame}{Downconversion}
		
	\end{frame}
	
	\begin{frame}{Balanced detector}
		
	\end{frame}
	
	\section{Conclusion and outlook}
	
	\begin{frame}{Conclusion and outlook}
	\end{frame}
	
	\appendix
	
	\begin{frame}{Classical post-processing pipeline}
		\begin{figure}
	\begin{tikzpicture}[
		block/.style={draw, very thick, minimum height=8mm},
	]
		\node[block, minimum width=8cm] (qt) at (0,0) {Quantum transmission};
		\node[block, minimum width=8cm] (pt) at (0,-1.2) {Partitioning};
		
		\node[block, minimum width=3.5cm] (sm) at (-2.25,-2.4) {Symbol mapping};
		\node[block, minimum width=4cm] (pe) at (2,-2.4) {Parameter estimation};
		\node[block, minimum width=6cm] (ir) at (-1,-3.6) {Information reconciliation};
		\node[block, minimum width=8cm] (pa) at (0,-4.8) {Privacy amplification};

		\draw[-Latex] (qt) -- (pt);
		\draw[Latex-] (sm.north) -- (sm.north|-pt.south);
		\draw[Latex-] (pe.north) -- (pe.north|-pt.south);
		\draw[-Latex] (sm.south) -- (sm.south|-ir.north);
		\draw[-Latex] (ir.south) -- (ir.south|-pa.north);

		\begin{scope}[transform canvas={xshift=-1cm}]
			\draw[-Latex] (pe.south) -- (pe.south|-ir.north);
		\end{scope}
		\begin{scope}[transform canvas={xshift=1cm}]
			\draw[-Latex] (pe.south) -- (pe.south|-pa.north);
		\end{scope}
		
		\node[block, rotate=90, minimum width=2.4cm] (ver) at (5,-4) {Verification};
		\node[block, rotate=90, minimum width=5.6cm] (abort) at (6.4,-2.4) {Abort protocol or discard block};
		\draw[-Latex] (pe.east) -- (pe.east-|abort.north);
		\draw[-Latex] (pa.east) -- (pa.east-|ver.north);
		\draw[-Latex] (ver.south) -- (ver.south-|abort.north);
	\end{tikzpicture}
		\caption{Block diagram of classical post-processing pipeline.}
		\end{figure}
	\end{frame}

\end{document}